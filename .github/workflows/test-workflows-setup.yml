name: Test Workflows Setup

on:
  workflow_dispatch:  # Manual trigger
  push:
    branches: [main]
    paths:
      - ".github/workflows/**"

jobs:
  test-setup:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout Repository
        uses: actions/checkout@v4

      - name: List Workflow Files
        run: |
          echo "ðŸ” Listing all workflow files in .github/workflows/"
          ls -la .github/workflows/

      - name: Validate YAML Syntax
        run: |
          echo "âœ… Validating YAML syntax for all workflows..."
          pip install pyyaml
          for file in .github/workflows/*.yml; do
            echo "Checking $file..."
            python3 -c "import yaml; yaml.safe_load(open('$file'))"
            echo "âœ… $file is valid"
          done

      - name: Test GitHub Script
        uses: actions/github-script@v7
        with:
          github-token: ${{ secrets.GITHUB_TOKEN }}
          script: |
            console.log('ðŸš€ GitHub Script is working for Smart Campus!');
            console.log('Repository:', context.repo.owner + '/' + context.repo.repo);
            console.log('Event:', context.eventName);

      - name: Optional API Call Example
        if: false # Currently disabled, reference only
        uses: actions/github-script@v7
        with:
          github-token: ${{ secrets.GITHUB_TOKEN }}
          script: |
            // Example: create a test issue
            github.issues.create({
              owner: context.repo.owner,
              repo: context.repo.repo,
              title: "Test Issue from Workflow",
              body: "This issue is automatically created by the Smart Campus workflow testing."
            });

      - name: Success Message
        run: |
          echo "ðŸŽ‰ All workflows are configured correctly for Smart Campus!"
          echo "ðŸ“‹ Current workflows in this repository:"
          echo "  - issue-comment.yml  -> Auto welcome & label issues"
          echo "  - pr-comment.yml     -> Auto welcome & label PRs with size and type"
          echo "  - first-time-contributor.yml -> Recognize first-time contributors"
          echo "  - status-updates.yml -> Automated status updates & reminders"
          echo ""
          echo "ðŸš€ What these workflows do:"
          echo "  - Welcome new issue and PR creators with detailed professional messages"
          echo "  - Automatically label issues & PRs based on content, type, and size"
          echo "  - Track first-time contributors and recognize their contributions"
          echo "  - Provide real-time status updates and reminders to maintainers"
          echo "  - Create weekly project summaries for management and contributors"
          echo ""
          echo "ðŸ’¡ All workflows are tested and ready for Smart Campus professional standards."
